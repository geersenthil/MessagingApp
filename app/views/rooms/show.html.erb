<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
      body {
          margin: 0 auto;
          max-width: 800px;
          padding: 0 20px;
      }

      .container {
          border: 2px solid #dedede;
          background-color: #f1f1f1;
          border-radius: 5px;
          padding: 10px;
          margin: 10px 0;
      }

      .darker {
          border-color: #ccc;
          background-color: #ddd;
      }

      .container::after {
          content: "";
          clear: both;
          display: table;
      }

      .container img {
          float: left;
          max-width: 60px;
          width: 100%;
          margin-right: 20px;
          border-radius: 50%;
      }

      .container img.right {
          float: right;
          margin-left: 20px;
          margin-right:0;
      }

      .time-right {
          float: right;
          color: #aaa;
      }

      .time-left {
          float: left;
          color: #999;
      }
  </style>
</head>
<h1>
  <%= @room.name %>
</h1>

<div class="row">
  <div class="col-12 col-md-3">
    <%= render partial: 'rooms' %>
  </div>
  <div class="col">
    <div class="chat">
      <% @messages.each do |room_message| %>
        <% if room_message.user == current_user %>
            <div class="container">
              <img src="/w3images/bandmember.jpg" alt="Avatar" style="width:100%;">
              <%= room_message.user.fullname %>
              <p><%= room_message.chattext %></p>
              <span class="time-right"><%= room_message.created_at %></span>
            </div>
       <%else %>
          <div class="container darker">
          <img src="/w3images/bandmember.jpg" alt="Avatar" style="width:100%;">
          <%= room_message.user.fullname %>
          <p><%= room_message.chattext %></p>
          <span class="time-left"><%= room_message.created_at %></span>
        </div>
        <%end %>

      <% end %>
    </div>

  <%= simple_form_for @message, remote: true do |form| %>
    <div class="input-group mb-3">
      <%= form.input :chattext, as: :string,
                     wrapper: false,
                     label: false,
                     input_html: {
                       class: 'chat-input',
                       autocomplete: 'off'
                     } %>
      <div class="input-group-append">
        <%= form.submit "Send", class: 'btn btn-primary chat-input' %>
      </div>
    </div>

    <%= form.input :room_id, as: :hidden %>
  <% end %>
  </div>
</div>